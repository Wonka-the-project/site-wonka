<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./vetores/w!.png" type="image/x-icon">
    <link rel="stylesheet" href="goldenticket.css">
    <script src="./wonkabar.js"></script>
    <title>Wonka!</title>
</head>
<body onload="montar_barra()">
    <div id="div_alert"
    style=" z-index: 99999; display: flex; align-items: center; justify-content: center;position: absolute; left: 38%;">
    </div>
    
     <!-- começando o header -->
     <div class="header-container" id="header">
        <header class="cabeca">
            <div>
                <img src="./vetores/chcolcate.svg" width="100%" class="chocolate_derretido">
            </div>

            <div class="nav_bar">
                <a href="#header"><img class="logo" src="./vetores/wonka logo.svg" width="140px"></a>

                <ul class="ul1">
                    <a href="./personagens.html">
                        <li>Personagens</li>
                    </a>
                    <a href="./tour.html">
                        <li>Tour pela Fábrica</li>
                    </a>
                    <a href="./loompalandia.html">
                        <li>Loompalândia</li>
                    </a>
                    <a href="wonkabar.html">
                        <li>Wonka Bar</li>
                    </a>
                </ul>

                <a href="./login.html"><img src="./vetores/login.svg" width="120px" class="ticket_login"></a>
            </div>
        </header>
    </div>
    <!-- fim do header -->

    <section class="comer_barra_container">
        <div class="quantos_comer">
            <img src="./vetores/logo wonkabar.svg" width="200px">

        <div>
            <span style="color: white;">Quantos pedaços</span>
            <input type="number" id="inp_num_pedaco" class="tag_input"><br>
        </div>
        <button onclick="comer()" class="botao_comer">Comer</button>
        </div>

        <div class="barra">
            <div class="pedaco">
                <div style="flex-wrap: wrap;" id="div_1"></div>
            </div>
        </div>

        <div class="porcentagem">
            <div class="fundo">
                <div style="height: fit-content; text-align: center;">
                <div>
                    <h3>Você já comeu</h3>
                </div>
                <div>
                    <h3 style="font-size: 25px;
                    font-weight: 900;"><span id="span2">0</span>/<span id="span1">14</span></h3>
                </div>
                <div>
                    <h3>pedaços.</h3>
                </div>
                <div>
                    <h3 style="font-size: 25px;
                    font-weight: 900;"><span id="span3">0</span>%</h3>
                </div>
                <div>
                    <h3>da barra</h3>
                </div>
            </div>
            </div>
        </div>
    </section>

</body>
</html>
<script>
    var barra_de_chocolate = JSON.parse(localStorage.getItem('barra_de_chocolate'));
    function montar_barra(){
    span1.innerHTML = `${barra_de_chocolate.pedaco}`

var src_imagem; 
if (barra_de_chocolate.chocolate == "ao leite" && barra_de_chocolate.confeito == "sem") {
    src_imagem = "./vetores/aoleite.svg";
} else if (barra_de_chocolate.chocolate == "branco" && barra_de_chocolate.confeito == "sem") {
    src_imagem = "./vetores/branco.svg";
} else if (barra_de_chocolate.chocolate == "ao leite" && barra_de_chocolate.confeito == "granulado") {
    src_imagem = "./vetores/aoleiteconfeito.svg";
} else if (barra_de_chocolate.chocolate == "branco" && barra_de_chocolate.confeito == "granulado") {
    src_imagem = "./vetores/brancoconfeito.svg";
} else if (barra_de_chocolate.chocolate == "ao leite" && barra_de_chocolate.confeito == "coco") {
    src_imagem = "./vetores/aoleitecoco.svg";
} else if (barra_de_chocolate.chocolate == "branco" && barra_de_chocolate.confeito == "coco") {
    src_imagem = "./vetores/brancococo.svg";
}


var contador = 1; // Certifique-se de inicializar o contador antes do loop
var div_1 = document.getElementById("div_1"); // Substitua "div_1" pelo ID correto da sua div

div_1.style.maxWidth = ((barra_de_chocolate.pedaco / 2) * 70) + "px"

while (contador <= barra_de_chocolate.pedaco) {
    div_1.innerHTML += `<img id="pedaco_${contador}" class="img_pedaco" src=${src_imagem} style="margin-right: -1px; margin-bottom: -5px;" width="70px">`;
    contador++;
}
}

var contas = 0

function comer() {
    var num_pedaco = Number(inp_num_pedaco.value)
    contas += num_pedaco
    
    var div_pedacos = document.querySelector("#div_1")

    if(contas == barra_de_chocolate.pedaco){
        ver_goldenticket()
    } 
    
    var contador_pedaco = 1;
    
        while (contador_pedaco <= num_pedaco) {
            var pedaco_atual = div_pedacos.children[contador_pedaco - 1]

            if(pedaco_atual.id == "o_br"){
                contador_pedaco++
            } else {
                div_pedacos.removeChild(pedaco_atual)
            }
            contador_pedaco++
            }
    
            
fazer_contas()
}

function fazer_contas(){
    span2.innerHTML = `${contas}`
    span3.innerHTML = `${((contas * 100) / barra_de_chocolate.pedaco).toFixed(0)}`
}

function ver_goldenticket(){
    span2.innerHTML = `${barra_de_chocolate.pedaco}`
    span3.innerHTML = `100`
    var aleatorio = Math.random()
    div_1.innerHTML = ``
    var sorteado = parseInt((aleatorio * 10) + 1)
    if(sorteado == 2 || sorteado == 4 ||sorteado == 6 ||sorteado == 8 ||sorteado == 10){

        div_1.innerHTML += `<span style="color: white; margin-top: -200px;">Parabéns! Você ganhou o Convite Dourado e mais 50 pontos.</span><br><br>`
        div_1.innerHTML += `<img src="./vetores/golden_ticket.svg" style="margin-left: -80px" width="500px"><br><br><br>`
    } else {
        div_1.innerHTML += `<span style="margin-left: 70px; color: white;">Não foi dessa vez! Você ganhou 10 pontos.</span><br><br>`
        div_1.innerHTML += `<img src="./vetores/aluminio.svg" style="margin-left: -80px" width="500px"><br><br><br>`
    }
        div_1.innerHTML += `<button  style="margin-left: 70px; margin-top: 20px;" onclick="window.location.href = './wonkabar.html'" class="botao_comer">Tentar Denovo</button>`
}
</script>

    
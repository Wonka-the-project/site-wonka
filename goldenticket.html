<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="./vetores/w!.png" type="image/x-icon">
    <link rel="stylesheet" href="goldenticket.css">
    <script src="./wonkabar.js"></script>
    <title>Wonka!</title>
</head>
<body onload="montar_barra()">

     <!-- começando o header -->
     <div class="header-container" id="header">
        <header class="cabeca">
            <div>
                <img src="./vetores/chcolcate.svg" width="100%" class="chocolate_derretido">
            </div>

            <div class="nav_bar">
                <a href="#header"><img class="logo" src="./vetores/wonka logo.svg" width="140px"></a>

                <ul class="ul1">
                    <a href="./personagens.html">
                        <li>Personagens</li>
                    </a>
                    <a href="./tour.html">
                        <li>Tour pela Fábrica</li>
                    </a>
                    <a href="./loompalandia.html">
                        <li>Loompalândia</li>
                    </a>
                    <a href="wonkabar.html">
                        <li>Wonka Bar</li>
                    </a>
                </ul>

                <a href="./login.html"><img src="./vetores/login.svg" width="120px" class="ticket_login"></a>
            </div>
        </header>
    </div>
    <!-- fim do header -->

    <section class="comer_barra_container">
        <div class="quantos_comer">
            <img src="./vetores/logo wonkabar.svg" width="200px">

        <div>
            <span style="color: white;">Qual pedaço</span>
            <input type="number" id="inp_num_pedaco" class="tag_input"><br>
        </div>
        <button onclick="comer()" class="botao_comer">Comer</button>
        </div>

        <div class="barra">
            <div class="pedaco">
                <div id="div_1"></div>
            </div>
        </div>

        <div class="porcentagem">
            <div class="fundo">
                <div style="height: fit-content; text-align: center;">
                <div>
                    <h3>Você já comeu</h3>
                </div>
                <div>
                    <h3 style="font-size: 25px;
                    font-weight: 900;"><span id="span2">0</span>/<span id="span1">14</span></h3>
                </div>
                <div>
                    <h3>pedaços.</h3>
                </div>
                <div>
                    <h3 style="font-size: 25px;
                    font-weight: 900;"><span id="span3">0</span>%</h3>
                </div>
                <div>
                    <h3>da barra</h3>
                </div>
            </div>
            </div>
        </div>
    </section>

</body>
</html>
<script>
    var barra_de_chocolate = JSON.parse(localStorage.getItem('barra_de_chocolate'));

    function montar_barra(){
    console.log (`${barra_de_chocolate}`)
    var contador = 1 

    span1.innerHTML = `${barra_de_chocolate.pedaco}`

    if (barra_de_chocolate.chocolate == "ao leite" && barra_de_chocolate.confeito == "sem"){
        var imagem = `<img id="pedaco_${contador}" src="./vetores/aoleite.svg" style="margin-right: -1px; margin-bottom: -5px;" width="70px">`
    } else if (barra_de_chocolate.chocolate == "branco" && barra_de_chocolate.confeito == "sem"){
        var imagem = `<img id="pedaco_${contador}" src="./vetores/branco.svg" style="margin-right: -1px; margin-bottom: -5px;" width="70px">`
    } else if (barra_de_chocolate.chocolate == "ao leite" && barra_de_chocolate.confeito == "granulado"){
        var imagem = `<img id="pedaco_${contador}" src="./vetores/aoleite confeito.svg" style="margin-right: -1px; margin-bottom: -5px;" width="70px">`
    } else if (barra_de_chocolate.chocolate == "branco" && barra_de_chocolate.confeito == "granulado"){
        var imagem = `<img id="pedaco_${contador}" src="./vetores/branco confeito.svg" style="margin-right: -1px; margin-bottom: -5px;" width="70px">`
    } else if (barra_de_chocolate.chocolate == "ao leite" && barra_de_chocolate.confeito == "coco"){
        var imagem = `<img id="pedaco_${contador}" src="./vetores/aoleite coco.svg" style="margin-right: -1px; margin-bottom: -5px;" width="70px">`
    } else if (barra_de_chocolate.chocolate == "branco" && barra_de_chocolate.confeito == "coco"){
        var imagem = `<img id="pedaco_${contador}" src="./vetores/branco coco.svg" style="margin-right: -1px; margin-bottom: -5px;" width="70px">`
    }

    while(contador <= barra_de_chocolate.pedaco){
        div_1.innerHTML += imagem
        if (contador === (barra_de_chocolate.pedaco / 2)){
            div_1.innerHTML += `<br>`
        } 
        contador++
    }
}

var contas = 0

function comer() {
    var contador_pedaco = 1;
    var num_pedaco = Number(inp_num_pedaco.value)
    contas += num_pedaco

    if(contas == barra_de_chocolate.pedaco){
        ver_goldenticket()
    }
            while (contador_pedaco <= num_pedaco) {
                var imagem = document.getElementById(`pedaco_${contador_pedaco}`);
                if (imagem) {
                    imagem.remove();
                }

                contador_pedaco++
            }
fazer_contas()
}

function fazer_contas(){
    span2.innerHTML = `${contas}`
    span3.innerHTML = `${((contas * 100) / barra_de_chocolate.pedaco).toFixed(0)}`
}

function ver_goldenticket(){
    var aleatorio = Math.random()
    div_1.innerHTML = ``
    var sorteado = parseInt((aleatorio * 10) + 1)
    if(sorteado == 2 || sorteado == 4 ||sorteado == 6 ||sorteado == 8 ||sorteado == 10){

        div_1.innerHTML += `<span style="color: white;">Parabéns! Você ganhou o Convite Dourado e mais 50 pontos.</span><br><br>`
        div_1.innerHTML += `<img src="./vetores/golden_ticket.svg" width="500px"><br><br><br>`
    } else {
        div_1.innerHTML += `<span style="margin-left: 70px; color: white;">Não foi dessa vez! Você ganhou 10 pontos.</span><br><br>`
        div_1.innerHTML += `<img src="./vetores/aluminio.svg" width="500px"><br><br><br>`
    }

    div_1.innerHTML += `<button  style="margin-left: 150px;" onclick="window.location.href = './wonkabar.html'" class="botao_comer">Tentar Denovo</button>`
}
</script>

    